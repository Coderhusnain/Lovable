import{u as h,r as n,j as e,am as m,s as u,a0 as r}from"./index-C8giHVQ3.js";import{C as x}from"./circle-check-Dc2HZFfN.js";const j=()=>{const s=h(),[l,a]=n.useState(null),[d,i]=n.useState(!0);return n.useEffect(()=>{(async()=>{try{i(!0);const t=window.location.href;if(console.log("Processing auth callback, URL:",t),t.includes("type=recovery")){console.log("Processing password recovery callback"),s("/reset-password",{replace:!0});return}if(t.includes("code=")){console.log("Processing OAuth callback");const{data:c,error:o}=await u.auth.exchangeCodeForSession(t);if(o){console.error("Code exchange error:",o),a(`Authentication failed: ${o.message}`),r.error("Authentication failed. Please try logging in again."),setTimeout(()=>s("/login",{replace:!0}),2e3);return}if(c!=null&&c.session){console.log("Authentication successful, session obtained"),r.success("Authentication successful!"),s("/user-dashboard",{replace:!0});return}else{console.error("No session returned after code exchange"),a("Authentication completed but no session was created. Please try logging in."),setTimeout(()=>s("/login",{replace:!0}),2e3);return}}const{data:g}=await u.auth.getSession();if(g.session){console.log("Session already exists"),r.success("Authentication successful!"),s("/user-dashboard",{replace:!0});return}console.error("No authentication method worked"),a("Authentication failed. Please try logging in again."),r.error("Authentication failed"),setTimeout(()=>s("/login",{replace:!0}),2e3)}catch(t){console.error("Authentication callback error:",t),a("An unexpected error occurred. Please try logging in again."),r.error("Authentication error"),setTimeout(()=>s("/login",{replace:!0}),2e3)}finally{i(!1)}})()},[s]),e.jsx("div",{className:"min-h-screen w-full flex flex-col items-center justify-center bg-rocket-blue-950",children:e.jsx("div",{className:"glass-card rounded-xl shadow-xl border border-rocket-blue-50/20 p-8 backdrop-blur-lg bg-white/5 max-w-md w-full mx-4",children:d?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-16 w-16 animate-spin rounded-full border-4 border-rocket-blue-300 border-t-rocket-blue-600 mx-auto"}),e.jsx("p",{className:"mt-6 text-white text-lg font-medium",children:"Processing authentication..."}),e.jsx("p",{className:"mt-2 text-rocket-gray-400 text-sm",children:"Please wait while we complete the process"})]}):l?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-red-900/30 p-3 rounded-full",children:e.jsx(m,{className:"h-10 w-10 text-red-500"})})}),e.jsx("p",{className:"text-red-400 text-lg font-medium mt-4",children:l}),e.jsx("p",{className:"text-rocket-gray-400 mt-2 text-sm",children:"Redirecting to login page..."})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-green-900/30 p-3 rounded-full",children:e.jsx(x,{className:"h-10 w-10 text-green-500"})})}),e.jsx("p",{className:"text-green-400 text-lg font-medium mt-4",children:"Authentication successful!"}),e.jsx("p",{className:"text-rocket-gray-400 mt-2 text-sm",children:"Redirecting to dashboard..."})]})})})};export{j as default};
