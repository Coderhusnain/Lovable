import{r as d,j as e,C as w,k as C,l as b,$ as u,b as E,a3 as I,a as f,A as P,aQ as A,J as r,s as F}from"./index-EUBTzQul.js";import{I as x}from"./input-BXL43AC-.js";import{L as h}from"./label-9rsijxaJ.js";const U=({onBack:p,onGenerate:g,documentType:j,isGenerating:t=!1})=>{const[s,N]=d.useState({fullName:"",email:""}),[l,n]=d.useState(!1),i=(a,c)=>{N(v=>({...v,[a]:c}))},o=a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),m=()=>s.fullName.trim().length>0&&s.email.trim().length>0&&o(s.email.trim()),y=async()=>{if(!m()){r.error("Please fill in all required fields with valid information.");return}n(!0);try{const{error:a}=await F.from("document_users").insert({full_name:s.fullName.trim(),email:s.email.trim().toLowerCase(),document_type:j,ip_address:null,user_agent:navigator.userAgent});if(a){console.error("Error storing user info:",a),r.error("There was an error saving your information. Please try again.");return}g(),r.success("Document generated successfully!")}catch(a){console.error("Error in handleGenerate:",a),r.error("An unexpected error occurred. Please try again.")}finally{n(!1)}};return e.jsxs(w,{children:[e.jsxs(C,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Contact Information"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Please provide your contact information to generate and download your document."})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(h,{htmlFor:"fullName",className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),"Full Name *"]}),e.jsx(x,{id:"fullName",value:s.fullName,onChange:a=>i("fullName",a.target.value),placeholder:"Enter your full name",className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsxs(h,{htmlFor:"email",className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),"Email Address *"]}),e.jsx(x,{id:"email",type:"email",value:s.email,onChange:a=>i("email",a.target.value),placeholder:"Enter your email address",className:"mt-1",required:!0}),s.email&&!o(s.email)&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Please enter a valid email address"})]}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsxs(f,{type:"button",variant:"outline",onClick:p,disabled:l||t,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Previous"]}),e.jsx(f,{type:"button",onClick:y,disabled:!m()||l||t,children:l||t?"Generating...":e.jsxs(e.Fragment,{children:["Generate PDF",e.jsx(A,{className:"w-4 h-4 ml-2"})]})})]})]})]})};export{U};
