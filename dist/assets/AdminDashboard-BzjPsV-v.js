import{c as ae,r as i,j as e,a as N,a5 as re,t as ss,s as C,a0 as j,a6 as ts,a7 as oe,a8 as ne,a9 as as,f as w,aa as le,ab as z,ac as q,ad as ie,ae as A,af as rs,ag as os,ah as ns,ai as ls,i as is,V as cs,W as ds,X as us,aj as X,k as ms,ak as I,Z as K,B as J,C as Z,u as xs,Y as gs,U as Q}from"./index-C8giHVQ3.js";import{r as hs}from"./adminAuth-lqn2D0kz.js";import{h as ps,S as fs,a as js,b as vs,i as Ns,j as bs,c as ys,d as U,e as O,k as ws}from"./sidebar-BrP0dPTI.js";import{I as ce}from"./input-ByhS0U14.js";import{T as de,c as ue,d as T,e as b,f as me,g as v,D as Cs,a as As,b as Ds,h as Ss,i as ks,j as Ts,k as _s,C as ee}from"./table-BzvMDLku.js";import{S as xe}from"./search-DjImIXza.js";import{c as ge,T as Rs,O as Ps,W as Es,C as $s,a as Gs,D as Is,b as he,P as Ms,R as Ls}from"./index-CSRvydWa.js";import{P as se}from"./phone-RStxOLfK.js";import{T as Fs}from"./trash-2-CP_r6-rb.js";import"./use-mobile-BL54gLIC.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=ae("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=ae("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),qs=()=>{const[s,t]=i.useState([]),[a,n]=i.useState(!0),[o,c]=i.useState(""),r=async d=>{try{n(!0);const{data:m,error:g}=await C.functions.invoke("get-all-users",{body:{searchTerm:d||o}});if(g){console.error("Error fetching users:",g),j.error("Failed to load users. Please try again later.");return}Array.isArray(m)?(t(m),console.log("Fetched users:",m)):(console.error("Invalid response format:",m),j.error("Received invalid data format from server."))}catch(m){console.error("Error fetching users:",m),j.error("Failed to load users. Please try again later.")}finally{n(!1)}};i.useEffect(()=>{r()},[]);const u=()=>{r(o)},x=async(d,m)=>{try{const{data:g,error:D}=await C.functions.invoke("manage-user",{body:{action:m,userId:d}});if(D){console.error(`Error ${m}ing user:`,D),j.error(`Failed to ${m} user`);return}g!=null&&g.success?(j.success(g.message||`User has been ${m==="ban"?"banned":"unbanned"}`),r()):j.error((g==null?void 0:g.message)||`Failed to ${m} user`)}catch(g){console.error(`Error ${m}ing user:`,g),j.error(`Failed to ${m} user`)}},p=s.filter(d=>{var m;return!o||((m=d.email)==null?void 0:m.toLowerCase())!=="admin@legalgram.com"});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"User Management"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ce,{placeholder:"Search users...",value:o,onChange:d=>c(d.target.value),className:"pl-8 w-[250px]",onKeyDown:d=>d.key==="Enter"&&u()})]}),e.jsx(N,{variant:"outline",onClick:u,children:"Search"}),e.jsxs(N,{variant:"outline",onClick:()=>r(),title:"Refresh users",className:"flex items-center gap-1",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Refresh"})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(de,{children:[e.jsx(ue,{children:e.jsxs(T,{children:[e.jsx(b,{children:"Name"}),e.jsx(b,{children:"Email"}),e.jsx(b,{children:"User ID"}),e.jsx(b,{children:"Registered"}),e.jsx(b,{children:"Last Login"}),e.jsx(b,{children:"Actions"})]})}),e.jsx(me,{children:a?e.jsx(T,{children:e.jsx(v,{colSpan:6,className:"text-center py-8",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-2 border-primary border-t-transparent"})})})}):p.length===0?e.jsx(T,{children:e.jsx(v,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No users found"})}):p.map(d=>{var m,g;return e.jsxs(T,{children:[e.jsx(v,{className:"font-medium",children:d.display_name||`${((m=d.user_metadata)==null?void 0:m.first_name)||""} ${((g=d.user_metadata)==null?void 0:g.last_name)||""}`.trim()||"-"}),e.jsx(v,{children:d.email}),e.jsx(v,{className:"font-mono text-xs truncate max-w-[150px]",title:d.id,children:d.id}),e.jsx(v,{children:d.created_at?new Date(d.created_at).toLocaleDateString():"N/A"}),e.jsx(v,{children:d.last_sign_in_at?new Date(d.last_sign_in_at).toLocaleDateString():"Never"}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{variant:"outline",size:"sm",className:"h-8 gap-1 text-red-500 hover:text-red-600 hover:bg-red-50",onClick:()=>x(d.id,"ban"),children:[e.jsx(Os,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Ban"})]}),e.jsxs(N,{variant:"outline",size:"sm",className:"h-8 gap-1 text-green-500 hover:text-green-600 hover:bg-green-50",onClick:()=>x(d.id,"unban"),children:[e.jsx(ss,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"Unban"})]})]})})]},d.id)})})]})})]})};var pe="AlertDialog",[zs,yt]=ts(pe,[ge]),k=ge(),fe=s=>{const{__scopeAlertDialog:t,...a}=s,n=k(t);return e.jsx(Ls,{...n,...a,modal:!0})};fe.displayName=pe;var Vs="AlertDialogTrigger",je=i.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,o=k(a);return e.jsx(Rs,{...o,...n,ref:t})});je.displayName=Vs;var Bs="AlertDialogPortal",ve=s=>{const{__scopeAlertDialog:t,...a}=s,n=k(t);return e.jsx(Ms,{...n,...a})};ve.displayName=Bs;var Hs="AlertDialogOverlay",Ne=i.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,o=k(a);return e.jsx(Ps,{...o,...n,ref:t})});Ne.displayName=Hs;var E="AlertDialogContent",[Ws,Ys]=zs(E),be=i.forwardRef((s,t)=>{const{__scopeAlertDialog:a,children:n,...o}=s,c=k(a),r=i.useRef(null),u=oe(t,r),x=i.useRef(null);return e.jsx(Es,{contentName:E,titleName:ye,docsSlug:"alert-dialog",children:e.jsx(Ws,{scope:a,cancelRef:x,children:e.jsxs($s,{role:"alertdialog",...c,...o,ref:u,onOpenAutoFocus:ne(o.onOpenAutoFocus,p=>{var d;p.preventDefault(),(d=x.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:p=>p.preventDefault(),onInteractOutside:p=>p.preventDefault(),children:[e.jsx(as,{children:n}),e.jsx(Ks,{contentRef:r})]})})})});be.displayName=E;var ye="AlertDialogTitle",we=i.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,o=k(a);return e.jsx(Gs,{...o,...n,ref:t})});we.displayName=ye;var Ce="AlertDialogDescription",Ae=i.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,o=k(a);return e.jsx(Is,{...o,...n,ref:t})});Ae.displayName=Ce;var Xs="AlertDialogAction",De=i.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,o=k(a);return e.jsx(he,{...o,...n,ref:t})});De.displayName=Xs;var Se="AlertDialogCancel",ke=i.forwardRef((s,t)=>{const{__scopeAlertDialog:a,...n}=s,{cancelRef:o}=Ys(Se,a),c=k(a),r=oe(t,o);return e.jsx(he,{...c,...n,ref:r})});ke.displayName=Se;var Ks=({contentRef:s})=>{const t=`\`${E}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${E}\` by passing a \`${Ce}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${E}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return i.useEffect(()=>{var n;document.getElementById((n=s.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},Js=fe,Zs=je,Qs=ve,Te=Ne,_e=be,Re=De,Pe=ke,Ee=we,$e=Ae;const et=Js,st=Zs,tt=Qs,Ge=i.forwardRef(({className:s,...t},a)=>e.jsx(Te,{className:w("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Ge.displayName=Te.displayName;const Ie=i.forwardRef(({className:s,...t},a)=>e.jsxs(tt,{children:[e.jsx(Ge,{}),e.jsx(_e,{ref:a,className:w("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...t})]}));Ie.displayName=_e.displayName;const Me=({className:s,...t})=>e.jsx("div",{className:w("flex flex-col space-y-2 text-center sm:text-left",s),...t});Me.displayName="AlertDialogHeader";const Le=({className:s,...t})=>e.jsx("div",{className:w("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});Le.displayName="AlertDialogFooter";const Fe=i.forwardRef(({className:s,...t},a)=>e.jsx(Ee,{ref:a,className:w("text-lg font-semibold",s),...t}));Fe.displayName=Ee.displayName;const Ue=i.forwardRef(({className:s,...t},a)=>e.jsx($e,{ref:a,className:w("text-sm text-muted-foreground",s),...t}));Ue.displayName=$e.displayName;const Oe=i.forwardRef(({className:s,...t},a)=>e.jsx(Re,{ref:a,className:w(le(),s),...t}));Oe.displayName=Re.displayName;const qe=i.forwardRef(({className:s,...t},a)=>e.jsx(Pe,{ref:a,className:w(le({variant:"outline"}),"mt-2 sm:mt-0",s),...t}));qe.displayName=Pe.displayName;function at(s,t=[]){let a=[];function n(c,r){const u=i.createContext(r),x=a.length;a=[...a,r];function p(m){const{scope:g,children:D,..._}=m,P=(g==null?void 0:g[s][x])||u,L=i.useMemo(()=>_,Object.values(_));return e.jsx(P.Provider,{value:L,children:D})}function d(m,g){const D=(g==null?void 0:g[s][x])||u,_=i.useContext(D);if(_)return _;if(r!==void 0)return r;throw new Error(`\`${m}\` must be used within \`${c}\``)}return p.displayName=c+"Provider",[p,d]}const o=()=>{const c=a.map(r=>i.createContext(r));return function(u){const x=(u==null?void 0:u[s])||c;return i.useMemo(()=>({[`__scope${s}`]:{...u,[s]:x}}),[u,x])}};return o.scopeName=s,[n,rt(o,...t)]}function rt(...s){const t=s[0];if(s.length===1)return t;const a=()=>{const n=s.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(c){const r=n.reduce((u,{useScope:x,scopeName:p})=>{const m=x(c)[`__scope${p}`];return{...u,...m}},{});return i.useMemo(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return a.scopeName=t.scopeName,a}var ot="Toggle",V=i.forwardRef((s,t)=>{const{pressed:a,defaultPressed:n=!1,onPressedChange:o,...c}=s,[r=!1,u]=z({prop:a,onChange:o,defaultProp:n});return e.jsx(q.button,{type:"button","aria-pressed":r,"data-state":r?"on":"off","data-disabled":s.disabled?"":void 0,...c,ref:t,onClick:ne(s.onClick,()=>{s.disabled||u(!r)})})});V.displayName=ot;var ze=V,$="ToggleGroup",[Ve,wt]=at($,[ie]),Be=ie(),B=A.forwardRef((s,t)=>{const{type:a,...n}=s;if(a==="single"){const o=n;return e.jsx(nt,{...o,ref:t})}if(a==="multiple"){const o=n;return e.jsx(lt,{...o,ref:t})}throw new Error(`Missing prop \`type\` expected on \`${$}\``)});B.displayName=$;var[He,We]=Ve($),nt=A.forwardRef((s,t)=>{const{value:a,defaultValue:n,onValueChange:o=()=>{},...c}=s,[r,u]=z({prop:a,defaultProp:n,onChange:o});return e.jsx(He,{scope:s.__scopeToggleGroup,type:"single",value:r?[r]:[],onItemActivate:u,onItemDeactivate:A.useCallback(()=>u(""),[u]),children:e.jsx(Ye,{...c,ref:t})})}),lt=A.forwardRef((s,t)=>{const{value:a,defaultValue:n,onValueChange:o=()=>{},...c}=s,[r=[],u]=z({prop:a,defaultProp:n,onChange:o}),x=A.useCallback(d=>u((m=[])=>[...m,d]),[u]),p=A.useCallback(d=>u((m=[])=>m.filter(g=>g!==d)),[u]);return e.jsx(He,{scope:s.__scopeToggleGroup,type:"multiple",value:r,onItemActivate:x,onItemDeactivate:p,children:e.jsx(Ye,{...c,ref:t})})});B.displayName=$;var[it,ct]=Ve($),Ye=A.forwardRef((s,t)=>{const{__scopeToggleGroup:a,disabled:n=!1,rovingFocus:o=!0,orientation:c,dir:r,loop:u=!0,...x}=s,p=Be(a),d=rs(r),m={role:"group",dir:d,...x};return e.jsx(it,{scope:a,rovingFocus:o,disabled:n,children:o?e.jsx(os,{asChild:!0,...p,orientation:c,dir:d,loop:u,children:e.jsx(q.div,{...m,ref:t})}):e.jsx(q.div,{...m,ref:t})})}),M="ToggleGroupItem",Xe=A.forwardRef((s,t)=>{const a=We(M,s.__scopeToggleGroup),n=ct(M,s.__scopeToggleGroup),o=Be(s.__scopeToggleGroup),c=a.value.includes(s.value),r=n.disabled||s.disabled,u={...s,pressed:c,disabled:r},x=A.useRef(null);return n.rovingFocus?e.jsx(ns,{asChild:!0,...o,focusable:!r,active:c,ref:x,children:e.jsx(te,{...u,ref:t})}):e.jsx(te,{...u,ref:t})});Xe.displayName=M;var te=A.forwardRef((s,t)=>{const{__scopeToggleGroup:a,value:n,...o}=s,c=We(M,a),r={role:"radio","aria-checked":s.pressed,"aria-pressed":void 0},u=c.type==="single"?r:void 0;return e.jsx(V,{...u,...o,ref:t,onPressedChange:x=>{x?c.onItemActivate(n):c.onItemDeactivate(n)}})}),Ke=B,Je=Xe;const Ze=ls("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),dt=i.forwardRef(({className:s,variant:t,size:a,...n},o)=>e.jsx(ze,{ref:o,className:w(Ze({variant:t,size:a,className:s})),...n}));dt.displayName=ze.displayName;const Qe=i.createContext({size:"default",variant:"default"}),es=i.forwardRef(({className:s,variant:t,size:a,children:n,...o},c)=>e.jsx(Ke,{ref:c,className:w("flex items-center justify-center gap-1",s),...o,children:e.jsx(Qe.Provider,{value:{variant:t,size:a},children:n})}));es.displayName=Ke.displayName;const G=i.forwardRef(({className:s,children:t,variant:a,size:n,...o},c)=>{const r=i.useContext(Qe);return e.jsx(Je,{ref:c,className:w(Ze({variant:r.variant||a,size:r.size||n}),s),...o,children:t})});G.displayName=Je.displayName;const ut=()=>{const[s,t]=i.useState([]),[a,n]=i.useState(!0),[o,c]=i.useState(""),[r,u]=i.useState(null),[x,p]=i.useState("all"),[d,m]=i.useState(!1);i.useEffect(()=>{console.log("ConsultationsTable component mounted, fetching data..."),g()},[x]);const g=async()=>{n(!0),console.log("Fetching consultations from Supabase...");try{let l=C.from("consultations").select("*");x!=="all"&&(l=l.eq("status",x));const{data:f,error:h}=await l;if(h){console.error("Error fetching consultations:",h),j.error("Failed to load consultations"),n(!1);return}console.log("Consultations fetched:",f),t(f||[])}catch(l){console.error("Unexpected error:",l),j.error("An unexpected error occurred")}finally{n(!1)}},D=()=>{if(!o.trim()){g();return}m(!0);try{const l=o.toLowerCase(),f=s.filter(h=>h.name.toLowerCase().includes(l)||h.email.toLowerCase().includes(l)||h.phone&&h.phone.toLowerCase().includes(l)||h.message.toLowerCase().includes(l));t(f)}finally{m(!1)}},_=async(l,f,h)=>{if(!l){console.error("Cannot create notification: No user ID provided");return}try{console.log(`Creating notification for user ${l} with title: ${f}`);const{error:S}=await C.from("notifications").insert({user_id:l,title:f,message:h,is_read:!1});if(S){console.error("Error creating notification:",S);return}console.log(`Notification created successfully for user ${l}`)}catch(S){console.error("Unexpected error creating notification:",S)}},P=async(l,f)=>{try{const{data:h,error:S}=await C.from("consultations").select("*").eq("id",l).single();if(S){console.error("Error fetching consultation:",S),j.error("Failed to update consultation status");return}const{error:Y}=await C.from("consultations").update({status:f}).eq("id",l);if(Y){console.error("Error updating consultation status:",Y),j.error("Failed to update consultation status");return}if(h&&h.email){let R=h.user_id;if(!R)try{const{data:{users:y},error:F}=await C.functions.invoke("get-user-by-email",{body:{email:h.email}});!F&&y&&y.length>0&&(R=y[0].id,await C.from("consultations").update({user_id:R}).eq("id",l))}catch(y){console.error("Error finding user by email:",y)}if(R){const y=f==="approved"?"Consultation Approved":"Consultation Rejected",F=f==="approved"?`Your consultation request regarding "${h.message.substring(0,30)}${h.message.length>30?"...":""}" has been approved.`:`Your consultation request regarding "${h.message.substring(0,30)}${h.message.length>30?"...":""}" has been rejected.`;await _(R,y,F)}else console.warn(`No user_id found for consultation ${l} with email ${h.email}`)}t(R=>R.map(y=>y.id===l?{...y,status:f}:y)),r&&r.id===l&&u({...r,status:f}),j.success(`Consultation ${f==="approved"?"approved":"rejected"} successfully`)}catch(h){console.error("Unexpected error:",h),j.error("An unexpected error occurred")}},L=async l=>{try{const{error:f}=await C.from("consultations").delete().eq("id",l);if(f){console.error("Error deleting consultation:",f),j.error("Failed to delete consultation");return}t(h=>h.filter(S=>S.id!==l)),j.success("Consultation deleted successfully")}catch(f){console.error("Unexpected error:",f),j.error("An unexpected error occurred")}},H=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),W=l=>{switch(l){case"pending":return"bg-yellow-100 text-yellow-800 hover:bg-yellow-100 border-yellow-200";case"approved":return"bg-green-100 text-green-800 hover:bg-green-100 border-green-200";case"rejected":return"bg-red-100 text-red-800 hover:bg-red-100 border-red-200";default:return""}};return e.jsxs(is,{className:"shadow-md border border-slate-200 dark:border-slate-800 animate-fade-in",children:[e.jsx(cs,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(ds,{className:"text-xl font-semibold",children:"Consultation Requests"}),e.jsx(us,{className:"text-slate-500 dark:text-slate-400",children:"Review and manage client consultation requests"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsx(xe,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ce,{placeholder:"Search consultations...",value:o,onChange:l=>c(l.target.value),className:"pl-8 w-full sm:w-[250px] bg-background border-slate-200 dark:border-slate-700",onKeyDown:l=>l.key==="Enter"&&D()})]}),e.jsx(N,{variant:"outline",onClick:D,disabled:d,className:"w-full sm:w-auto",children:d?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4 mr-2 animate-spin"}),"Searching..."]}):"Search"}),e.jsxs(N,{variant:"outline",onClick:g,className:"gap-1 w-full sm:w-auto",children:[e.jsx(re,{className:`h-4 w-4 ${a?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]})]})}),e.jsxs(ms,{className:"space-y-4 pt-2",children:[e.jsxs(es,{type:"single",value:x,onValueChange:l=>{l&&p(l)},className:"justify-start border rounded-lg p-1 bg-slate-50 dark:bg-slate-900",children:[e.jsx(G,{value:"all",className:"text-sm data-[state=on]:bg-white dark:data-[state=on]:bg-slate-800 data-[state=on]:text-primary data-[state=on]:shadow-sm",children:"All"}),e.jsx(G,{value:"pending",className:"text-sm text-yellow-800 data-[state=on]:bg-yellow-100 data-[state=on]:text-yellow-900",children:"Pending"}),e.jsx(G,{value:"approved",className:"text-sm text-green-800 data-[state=on]:bg-green-100 data-[state=on]:text-green-900",children:"Approved"}),e.jsx(G,{value:"rejected",className:"text-sm text-red-800 data-[state=on]:bg-red-100 data-[state=on]:text-red-900",children:"Rejected"})]}),e.jsx("div",{className:"rounded-md border border-slate-200 dark:border-slate-800 overflow-hidden",children:e.jsxs(de,{children:[e.jsx(ue,{className:"bg-slate-50 dark:bg-slate-900",children:e.jsxs(T,{className:"border-slate-200 dark:border-slate-800 hover:bg-slate-100 dark:hover:bg-slate-800/50",children:[e.jsx(b,{className:"font-medium",children:"Name"}),e.jsx(b,{className:"font-medium",children:"Email"}),e.jsx(b,{className:"font-medium",children:"Phone"}),e.jsx(b,{className:"font-medium",children:"Request"}),e.jsx(b,{className:"font-medium",children:"Date"}),e.jsx(b,{className:"font-medium",children:"Status"}),e.jsx(b,{className:"font-medium",children:"Actions"})]})}),e.jsx(me,{children:a?e.jsx(T,{children:e.jsx(v,{colSpan:7,className:"text-center py-12 bg-white dark:bg-slate-950",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(X,{className:"h-8 w-8 animate-spin text-primary mb-3"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Loading consultation requests..."})]})})}):s.length===0?e.jsx(T,{children:e.jsx(v,{colSpan:7,className:"text-center py-12 bg-white dark:bg-slate-950",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 max-w-sm mx-auto",children:[e.jsx(I,{className:"h-8 w-8 text-slate-300 dark:text-slate-600 mb-2"}),e.jsx("h3",{className:"text-lg font-medium",children:"No consultation requests found"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-center text-sm",children:o?"No requests match your search criteria. Try using different keywords or clear your search.":x!=="all"?`No ${x} consultation requests found.`:"When clients request consultations, they will appear here."}),o&&e.jsx(N,{variant:"outline",onClick:()=>{c(""),g()},className:"mt-2",children:"Clear search"})]})})}):s.map(l=>e.jsxs(T,{className:"border-slate-200 dark:border-slate-800 hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"h-4 w-4 mr-2 text-slate-400"}),e.jsx("span",{className:"font-medium",children:l.name})]})}),e.jsx(v,{className:"text-slate-600 dark:text-slate-300",children:l.email}),e.jsx(v,{className:"text-slate-600 dark:text-slate-300",children:l.phone?e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"h-3.5 w-3.5 mr-1.5 text-slate-400"}),l.phone]}):"Not provided"}),e.jsx(v,{className:"max-w-[200px] truncate text-slate-600 dark:text-slate-300",children:l.message.substring(0,40)+(l.message.length>40?"...":"")}),e.jsx(v,{className:"text-slate-600 dark:text-slate-300",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-3.5 w-3.5 mr-1.5 text-slate-400"}),H(l.created_at)]})}),e.jsx(v,{children:e.jsx(J,{className:`${W(l.status)} transition-colors`,variant:"outline",children:l.status.charAt(0).toUpperCase()+l.status.slice(1)})}),e.jsx(v,{children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs(Cs,{children:[e.jsx(As,{asChild:!0,children:e.jsxs(N,{variant:"outline",size:"sm",className:"h-8 gap-1 border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900",onClick:()=>u(l),children:[e.jsx(I,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:"View"})]})}),e.jsx(Ds,{className:"sm:max-w-md",children:r&&e.jsxs(e.Fragment,{children:[e.jsxs(Ss,{children:[e.jsx(ks,{children:"Consultation Request"}),e.jsxs(Ts,{children:["From ",r.name]})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Name:"}),e.jsxs("p",{className:"flex items-center mt-1",children:[e.jsx(K,{className:"h-4 w-4 mr-2 text-slate-400"}),r.name]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Email:"}),e.jsx("p",{className:"mt-1",children:r.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Phone:"}),e.jsxs("p",{className:"flex items-center mt-1",children:[e.jsx(se,{className:"h-4 w-4 mr-2 text-slate-400"}),r.phone||"Not provided"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Request:"}),e.jsx("p",{className:"mt-1 p-3 bg-slate-50 dark:bg-slate-900 rounded-md text-slate-700 dark:text-slate-300",children:r.message})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Date:"}),e.jsx("p",{className:"mt-1",children:H(r.created_at)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"Status:"}),e.jsx("p",{className:"mt-1",children:e.jsx(J,{className:`${W(r.status)}`,variant:"outline",children:r.status.charAt(0).toUpperCase()+r.status.slice(1)})})]}),e.jsxs(_s,{className:"flex justify-end gap-2 mt-6",children:[e.jsxs(N,{variant:"outline",className:"gap-1 text-red-500 hover:bg-red-50 hover:text-red-600 border-red-200",onClick:()=>{P(r.id,"rejected")},disabled:r.status==="rejected",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Reject"})]}),e.jsxs(N,{className:"gap-1",onClick:()=>{P(r.id,"approved")},disabled:r.status==="approved",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:"Approve"})]})]})]})]})})]}),e.jsxs(N,{variant:"outline",size:"sm",className:"h-8 gap-1 text-green-500 hover:text-green-600 hover:bg-green-50 border-green-200",onClick:()=>P(l.id,"approved"),disabled:l.status==="approved",children:[e.jsx(Z,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Approve"})]}),e.jsxs(N,{variant:"outline",size:"sm",className:"h-8 gap-1 text-red-500 hover:text-red-600 hover:bg-red-50 border-red-200",onClick:()=>P(l.id,"rejected"),disabled:l.status==="rejected",children:[e.jsx(ee,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Reject"})]}),e.jsxs(et,{children:[e.jsx(st,{asChild:!0,children:e.jsxs(N,{variant:"outline",size:"sm",className:"h-8 gap-1 text-red-500 hover:text-red-600 hover:bg-red-50 border-red-200",children:[e.jsx(Fs,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only sm:not-sr-only",children:"Delete"})]})}),e.jsxs(Ie,{children:[e.jsxs(Me,{children:[e.jsx(Fe,{children:"Delete Consultation"}),e.jsxs(Ue,{children:["Are you sure you want to delete this consultation request from ",l.name,"? This action cannot be undone."]})]}),e.jsxs(Le,{children:[e.jsx(qe,{children:"Cancel"}),e.jsx(Oe,{className:"bg-red-500 hover:bg-red-600",onClick:()=>L(l.id),children:"Delete"})]})]})]})]})})]},l.id))})]})})]})]})},Ct=()=>{const s=xs(),[t,a]=i.useState(!1),[n,o]=i.useState(!0),[c,r]=i.useState("dashboard");i.useEffect(()=>{(async()=>{o(!0);const p=await hs(s);a(p),o(!1)})()},[s]);const u=async()=>{try{const{error:x}=await C.auth.signOut();if(x){j.error("Error logging out");return}j.success("Logged out successfully"),s("/login")}catch(x){console.error("Logout error:",x),j.error("An unexpected error occurred")}};return n?e.jsx("div",{className:"flex h-screen w-full items-center justify-center",children:e.jsx("div",{className:"h-16 w-16 animate-spin rounded-full border-4 border-primary/30 border-t-primary"})}):t?e.jsx(ps,{defaultOpen:!0,children:e.jsxs("div",{className:"min-h-screen flex w-full bg-rocket-gray-900",children:[e.jsxs(fs,{children:[e.jsxs(js,{className:"py-6 flex justify-between items-center",children:[e.jsxs("div",{className:"px-3",children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Admin Dashboard"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Manage your legal platform"})]}),e.jsx(N,{variant:"ghost",size:"icon",onClick:u,className:"mr-3 hover:bg-destructive/10",title:"Logout",children:e.jsx(gs,{className:"h-5 w-5 text-destructive"})})]}),e.jsx(vs,{children:e.jsxs(Ns,{children:[e.jsx(bs,{children:"Main"}),e.jsxs(ys,{children:[e.jsx(U,{children:e.jsxs(O,{onClick:()=>r("dashboard"),isActive:c==="dashboard",children:[e.jsx(Us,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Dashboard"})]})}),e.jsx(U,{children:e.jsxs(O,{onClick:()=>r("consultations"),isActive:c==="consultations",children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Consultations"})]})}),e.jsx(U,{children:e.jsxs(O,{onClick:()=>r("users"),isActive:c==="users",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Manage Users"})]})})]})]})})]}),e.jsx(ws,{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[c==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Welcome back, Admin"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage legal documents, user subscriptions, and platform settings."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-rocket-gray-800 p-6 rounded-lg shadow-sm border border-rocket-gray-700 cursor-pointer hover:border-primary transition-colors",onClick:()=>r("consultations"),children:[e.jsx(I,{className:"h-8 w-8 mb-4 text-primary"}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"Consultations"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Review and manage consultation requests."})]}),e.jsxs("div",{className:"bg-rocket-gray-800 p-6 rounded-lg shadow-sm border border-rocket-gray-700 cursor-pointer hover:border-primary transition-colors",onClick:()=>r("users"),children:[e.jsx(Q,{className:"h-8 w-8 mb-4 text-primary"}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"User Management"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Manage users, subscriptions and permissions."})]})]})]}),c==="consultations"&&e.jsx(ut,{}),c==="users"&&e.jsx(qs,{})]})})]})}):null};export{Ct as default};
