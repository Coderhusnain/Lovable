import{J as e,s as o}from"./index-EUBTzQul.js";const a="admin@legalgram.com",t="legalgram.admin",c=async()=>{const{data:r}=await o.auth.getSession();return r.session?r.session.user.email===a:!1},l=async()=>{try{console.log("Ensuring admin user exists...");const{data:r,error:n}=await o.functions.invoke("manage-user",{body:{action:"create-admin",email:a,password:t}});return n?(console.error("Admin creation error:",n),e.error(`Error connecting to server: ${n.message}`),!1):r!=null&&r.success?(console.log("Admin ensure success:",r.message),console.log("Admin user ID:",r.userId),!0):(e.error("Failed to verify admin account"),!1)}catch(r){return console.error("Admin user check/creation error:",r),e.error("Connection error: Please try again later"),!1}},m=async(r,n)=>{if(r!==a)return e.error("Invalid admin credentials"),!1;try{if(console.log("Starting admin login process"),!await l())return console.error("Failed to ensure admin exists"),e.error("Failed to verify admin account"),!1;console.log("Attempting to sign in with admin credentials");const{data:d,error:s}=await o.auth.signInWithPassword({email:r,password:n});return s?(console.error("Admin login error:",s.message),e.error("Admin authentication failed: "+s.message),!1):(console.log("Admin login successful"),e.success("Admin login successful"),!0)}catch(i){return console.error("Admin login error:",i),e.error("An unexpected error occurred during admin login"),!1}},g=async r=>await c()?!0:(e.error("Admin access required"),r("/admin-login"),!1);export{m as l,g as r};
